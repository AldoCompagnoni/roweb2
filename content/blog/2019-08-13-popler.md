---
slug: "popler"
title: Synthesizing of population time-series data from the USA Long Term Ecological Research Network
package_version: 0.2.0
authors:
  - Aldo Compagnoni
date: 2019-08-13
categories: blog
topicid:
tags:
- Software Peer Review
- R
- community
---

Introduction including outline of the post.

### Introduction

I like Hugo[^1]. Yes, that is how you add a footnote.

The availability of large quantities of freely available data is revolutionizing the world of ecological research. Large dataset, by facilitating comparative analyses and meta-analyses, are a boon to synthesis work. Such synthesis efforts will make large use of time-series population abundance data , which plays a central role in testing ecological theory and guiding management decisions. One of the richest sources of open access population data is the USA Long Term Ecological Research (LTER) Network. However, LTER data presents the drawback common to all ecological time-series data: extreme heterogeneity derived from substantial differences in sampling designs. Such heterogeneity poses two main challenges: it is hard to find population data of interest, and it is hard to compare this data in analyses.

To alleviate this issue, we created popler: an online PostgreSQL database (henceforth "popler online database"), and associated R client (henceforth "popler R package"). popler accommodates raw population time-series data using the same structure for all datasets. Using raw data, without aggregation, promotes flexibility in data analysis. Moreover, using a common data structure implies that all datasets share the same variables, or the same type of variables. As a result, popler facilitates comparing, manipulating, and retrieving population data. 

#### First awesome subsection of the first awesome section

Here's how to use a Hugo shortcode to add an image. 

{{< figure src = "/img/blog-images/2019-06-04-post-template/name-of-image.png" width = "200" alt = "this is the alternative text" >}}

We strove to make user-friendliness the hallmark of the popler R package. To facilitate use, we created as few functions as possible: popler relies on essentially two functions: pplr_browse(), which you can use to see what type of data is available in popler, and pplr_get_data(), to download dataset from the popler online database.
pplr_browse() allows to select which one of the 305 datasets satisfies user-specified criteria. These criteria will depend on the metadata variables used to describe the dataset stored in popler. These metadata variables, and their contenct, is described by function pplr_dictionary().
Once a user understands the meaning and content of metadata variables, she/he can use pplr_browse() to explore which datasets satisfy certain criteria. For example, one could be interested in experimental datasets, that quantify population abundance using cover measurements, and that are at least 20-year long. To see which of these data are available, the user should run:

pplr_browse( studytype == 'exp' & datatype == 'cover' & duration_years > 20 )

This line of code shows that there are only four datasets with these characteristics. If interested we can download these directly:

pplr_get_data( datatype == 'cover' & studytype == 'exp' & duration_years > 20 )

#### Second awesome subsection

One of the biggest hurdles in creating the popler R package was integrating it with an Application Programming Interface (API) that allows secure access to the popler online database. In principle, the popler R package could access the popler online database directly from R using functionalities of R packages such as RPostgreSQL. However, this poses substantial security threats, and in fact our online database did experience a minor security breach during its time not protected by an API. We therefore welcome the suggestion to use an API by Noam Ross, from rOpenSci. Subsequently, Scott Chamberlain, also from rOpenSci, was kind enough to develop the API using the Ruby language, the code for which is currently stored on github.

Querying an SQL database using an API improves security, but poses a few limitations on the features of the popler R package, and imposes the additional challenge of managing the API. The API limits the ways in which the R package can query the popler online database. In particular, our API allows querying popler in two ways: downloading the metadata of all 305 datasets, and downloading entire datasets. Fortunately, these two queries reflect the vast majority of queries that make the popler R package tick. In particular, metadata of all 305 datasets is essentially what is used by the pplr_browse() function. Moreover, our own preliminary use of popler, we used the function pplr_get_data() almost only to download entire datasets. Hence, the limitation posed by the API were of little importance when weighed against the benefit provided by increased security. As a side note, using an API provides a minor, yet somewhat enticing perk: a progress bar for the downloads of pplr_get_data().

The API also need be managed in order to avoid crashes which make downloads impossible. The API crashes whenever the online database is stopped and restarted, and whenever the API web service crashes. Stopping and re-starting the database occur, for example, when we want changes to the popler online database configuration to take effect. In those rare cases, the API will crash after stopping the database, and it will need to be restarted. Moreover, the API will stop working whenever its web service crashes. These crashes have happened occasionally in the past, and they require restarting the API. To monitor whether the web service of our API works, we use Uptime Robot, a free application that quantifies the time during which the web server is available to users.

Here's how to use a Hugo shortcode to embed a tweet. We recommend the use of [Hugo shortcodes](https://gohugo.io/content-management/shortcodes/) to include tweets, Vimeo or Youtube videos, gists, etc.

{{< tweet 1138216112808529920 >}}

### Conclusion

Our work with popler highlighted many opportunities linked to data synthesis using long-term population data. Specifically, we found that population time-series data, while containing sometimes daunting heterogeneities, also present conspicuous regularities. By "regularities", we mean that population abundance can be quantified in just a few ways (e.g. using densities, counts, area covered, ect.), that all datasets have a temporal replication of population censuses, a spatial replication structure (which is often times nested), and so on. Our work with popler showed that these regularities can be used to format most population time-series under the same structure. These regularities show great promise population, community, and macro ecology. 

Here's how to add the footnote text for your reference above.

[^1]: Hugo! https://gohugo.io/
